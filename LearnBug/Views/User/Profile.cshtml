@model ViewModels.ProfileViewModel
@{
    ViewBag.Title = Model.User.Username;

}
<div class="row">
    <div class="col-sm-8">
        <div class="bg-picture card-box">
            <div class="profile-info-name">
                <img src="@Model.User.ImgProfile()"
                     class="img-thumbnail" alt="profile-image">

                <div class="profile-info-detail">
                    <h3 class="m-t-0 m-b-0">@Model.User.Name</h3>
                    <p class="text-muted m-b-20"><i>@Model.User.Roles</i></p>
                    <p>
                        @Model.User.Biography
                    </p>

                    <div class="button-list m-t-20">
                        <button type="button" class="btn btn-facebook btn-sm waves-effect waves-light">
                            <i class="fa fa-facebook"></i>
                        </button>

                        <button type="button" class="btn btn-sm btn-twitter waves-effect waves-light">
                            <i class="fa fa-twitter"></i>
                        </button>

                        <button type="button" class="btn btn-sm btn-linkedin waves-effect waves-light">
                            <i class="fa fa-linkedin"></i>
                        </button>

                        <button type="button" class="btn btn-sm btn-dribbble waves-effect waves-light">
                            <i class="fa fa-dribbble"></i>
                        </button>

                    </div>
                </div>

                <div class="clearfix"></div>
            </div>
        </div>
        <!--/ meta -->
        @if (Model.User.Username != User.Identity.Name)
        {
            <div class="card-box">
                <fieldset>
                    <span class="input-icon icon-right">
                        <textarea rows="2" id="TextMessage" class="form-control" placeholder="نوشتن یک پیام"></textarea>
                    </span>
                    <div class="p-t-10 pull-right">
                        <a class="btn btn-sm btn-primary waves-effect waves-light" onclick="SendMessage('@Model.User.Id')">ارسال</a>
                    </div>
                </fieldset>
            </div>
        }
        @if (Model.Posts != null)
        {
            <div class="card-box">
                @foreach (var item in Model.Posts)
                {
                    <div class="fa-border form-group">
                        <div class="">
                            <a href="#" title=""> @item.Group.Name </a>
                            @item.InsertDateTime.ToPersianDate()

                        </div>
                        @item.Subject
                    </div>

                }

            </div>
        }
    </div>

    <div class="col-sm-4">
        <div class="card-box">
            <div class="dropdown pull-right">
                <a href="#" class="dropdown-toggle card-drop" data-toggle="dropdown" aria-expanded="false">
                    <i class="zmdi zmdi-more-vert"></i>
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="@Url.Action("Following","Follow",new {id=Model.User.Username })">دنبال شده ها</a></li>
                    <li><a href="@Url.Action("Followers","Follow",new {id=Model.User.Username })">دنبال کنندگان</a></li>
                </ul>
            </div>

            <h4 class="header-title m-t-0 m-b-30"> دوستان </h4>
            <ul class="list-group m-b-0 user-list">
                @foreach (var item in Model.Follower)
                {
                    <li class="list-group-item">
                        <a href="@Url.Action("Profile", "User", new { id = item.Username })" class="user-list-item">
                            <div class="avatar">
                                <img src="@item.ImgProfile()" alt="">
                            </div>
                            <div class="user-desc">
                                <span class="name">@item.Name</span>
                                <span class="desc">@item.Roles</span>
                            </div>
                        </a>
                    </li>

                }


            </ul>
        </div>

        <div class="card-box">
            @*<div class="dropdown pull-right">
                    <a href="#" class="dropdown-toggle card-drop" data-toggle="dropdown" aria-expanded="false">
                        <i class="zmdi zmdi-more-vert"></i>
                    </a>
                    <ul class="dropdown-menu" role="menu">

                        <li><a href="#">متن اول</a></li>
                        <li><a href="#">متن دوم</a></li>
                        <li><a href="#">متن سوم</a></li>
                        <li class="divider"></li>
                        <li><a href="#">متن چهارم</a></li>
                    </ul>
                </div>*@

            <h4 class="header-title m-t-0 m-b-30"><i class="zmdi zmdi-notifications-none m-r-5"></i>جزئیات کاربر</h4>

            <ul class="list-group m-b-0 user-list">
                <li class="list-group-item">
                    <a href="#" class="user-list-item">
                        <div class="avatar text-center">
                            <i class="zmdi zmdi-circle text-primary"></i>
                        </div>
                        <div class="user-desc">
                            <span class="name">نام کاربری</span>
                            <span class="desc">@Model.User.Username</span>
                        </div>
                    </a>
                </li>
                <li class="list-group-item">
                    <a href="#" class="user-list-item">
                        <div class="avatar text-center">
                            <i class="zmdi zmdi-circle text-warning"></i>
                        </div>
                        <div class="user-desc">
                            <span class="name">نام</span>
                            <span class="desc">@Model.User.Name</span>
                        </div>
                    </a>
                </li>

                @if (User.IsInRole("admin") || Model.User.Username == User.Identity.Name)
                {
                    <li class="list-group-item">
                        <a href="#" class="user-list-item">
                            <div class="avatar text-center">
                                <i class="zmdi zmdi-circle text-info"></i>
                            </div>
                            <div class="user-desc">
                                <span class="name">ایمیل</span>
                                <span class="desc">@Model.User.Email</span>
                            </div>
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="#" class="user-list-item">
                            <div class="avatar text-center">
                                <i class="zmdi zmdi-circle text-danger"></i>
                            </div>
                            <div class="user-desc">
                                <span class="name">شماره تلفن</span>
                                <span class="desc">@Model.User.Phone</span>
                            </div>
                        </a>
                    </li>
                }

                <li class="list-group-item">
                    <a href="#" class="user-list-item">
                        <div class="avatar text-center">
                            <i class="zmdi zmdi-circle text-success"></i>
                        </div>
                        <div class="user-desc">
                            <span class="name">تاریخ تولد</span>
                            <span class="desc">@Model.User.Dateofbirth.ToPersianDate()</span>
                        </div>
                    </a>
                </li>
                <li class="list-group-item">
                    <a href="#" class="user-list-item">
                        <div class="avatar text-center">
                            <i class="zmdi zmdi-circle text-pink"></i>
                        </div>
                        <div class="user-desc">
                            <span class="name">جنسیت</span>
                            <span class="desc">@Model.User.Gender</span>
                        </div>
                    </a>
                </li>

                @if (User.IsInRole("admin") || Model.User.Username == User.Identity.Name)
                {
                    <li class="list-group-item">
                        <a href="#" class="user-list-item">
                            <div class="avatar text-center">
                                <i class="zmdi zmdi-circle text-muted"></i>
                            </div>
                            <div class="user-desc">
                                <span class="name">کمیسیون</span>
                                <span class="desc">@Model.User.Commission %</span>
                            </div>
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="#" class="user-list-item">
                            <div class="avatar text-center">
                                <i class="zmdi zmdi-circle text-inverse"></i>
                            </div>
                            <div class="user-desc">
                                <span class="name">کیف پول</span>
                                <span class="desc">@Model.User.Wallet.ToPrice() $</span>
                            </div>
                        </a>
                    </li>
                }
            </ul>
        </div>

    </div>
</div>


@section scripts{

    <script>
        function SendMessage(userid) {
                $.ajax({
                    url: "@Url.Action("SendMessage","Message")",
                    data: { text: document.getElementById('TextMessage').value, to: userid },
                    type: "Post",
                    dataType: "JavaScript",
                    success: function () {
                        document.getElementById("SendMessage").value=""
                    }
                })
        }



        function Follow(id) {
            var w = $("#btnFollow").val()
            var typ = true
            if (w == "UnFollow") {
                $("#btnFollow").val("Follow")
                typ = false
            } else {
                $("#btnFollow").val("UnFollow")
                typ = true
            }
            $.ajax({
                url: "/Follow/Follow",
                data: { userId: id, type: typ },
                type: "Post",
                datatype: "Json"
            })
        }

    </script>
}